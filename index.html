<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Jemputan Perkahwinan — Isma & Fikri</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{
      --accent:#a67c52;
      --muted:#6b7280;
      --overlay-fade-ms:400ms;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{font-family:'Poppins',sans-serif;background:#fbfcf8;color:#111;-webkit-font-smoothing:antialiased;
      padding-bottom:calc(140px + env(safe-area-inset-bottom));
      overflow-x:hidden;
    }

    @font-face { font-family: 'FlashFont'; src: url('the flash TTF.ttf') format('truetype'); font-weight: normal; font-style: normal; }

    /* background fallback */
    .bg-video{ position: fixed; inset: 0; z-index: -5; pointer-events: none; display:flex; align-items:center; justify-content:center; background: transparent; overflow:hidden;}
    .bg-video img{ max-width:100%; max-height:100vh; width:auto; height:auto; object-fit:contain; object-position:center center; display:block; }

    .app{ max-width:420px; margin:auto; position:relative; min-height:100vh; scroll-snap-type:y mandatory; overflow-y:auto; -webkit-overflow-scrolling:touch; padding-bottom:140px; z-index:1; }
    section{ scroll-snap-align:start; min-height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; position:relative; }

    /* keep .content but no white box */
    .content{
      background: transparent !important;
      backdrop-filter: none !important;
      border-radius: 0 !important;
      padding: 0 !important;
      box-shadow: none !important;
      position: relative;
      z-index: 2;
      margin: 0 !important;
      max-width: 100%;
    }

    /* ensure readable text above background */
    .intro-text, #mainCard, .parent-name, .couple-name, p, h2 {
      color: #fff;
      text-shadow: 0 6px 18px rgba(0,0,0,0.45);
    }

    /* base/overlay backgrounds */
    section.intro-section::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url("https://invitation-v2.mymawaddah.com/storage/wedapp-invitation/design/fr0042/6jgvkT17552257093998.jpg");
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      z-index: -3;
      pointer-events: none;
    }
    section.intro-section::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url("https://invitation-v2.mymawaddah.com/storage/wedapp-invitation/design/fr0042/ctQB591755233073171FR0042(1).png");
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      opacity: 0.99;
      mix-blend-mode: normal;
      z-index: -2;
      pointer-events: none;
    }

    /* ===========================
       FIXED OVERLAYS (WITH FADE-IN, PERMANENT AFTER FIRST SHOW)
       =========================== */
    .fixed-overlay {
      position: fixed;
      left: 50%;
      transform: translateX(-50%) translateY(0);
      pointer-events: none;
      z-index: 10005;
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--overlay-fade-ms) ease, transform var(--overlay-fade-ms) ease, visibility 10ms linear;
      will-change: transform, opacity;
    }

    .fixed-overlay.primary {
      top: 8vh;
      width: 86%;
      max-width: 420px;
      transform: translateX(-50%) translateY(-8px);
    }
    .fixed-overlay.primary img{ width:100%; height:auto; display:block; object-fit:contain; user-select:none; -webkit-user-drag:none; }

    .fixed-overlay.secondary {
      top: 4vh;
      width: 92%;
      max-width: 460px;
      transform: translateX(-50%) translateY(-14px);
      z-index: 10006;
    }
    .fixed-overlay.secondary img{ width:100%; height:auto; display:block; object-fit:contain; user-select:none; -webkit-user-drag:none; }

    /* VISIBLE state: fades in (transition defined above) */
    .fixed-overlay.visible {
      opacity: 0.98;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }

    /* other UI */
    .modal{ display:none; position:fixed; z-index:9999; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.8) }
    .modal-content{ margin:auto; display:block; max-width:90%; max-height:90%; border-radius:10px }
    .close{ position:absolute; top:15px; right:25px; color:white; font-size:30px; font-weight:bold; cursor:pointer }

    .countdown{ display:flex; justify-content:center; gap:8px; margin-top:12px }
    .countdown div{ background:rgba(255,255,255,0.08); padding:8px 10px; border-radius:8px; min-width:54px }
    .countdown .num{ font-weight:700; font-size:16px }
    .countdown .lbl{ font-size:11px; color:var(--muted) }

    .bottom-bar{ position:fixed; left:50%; transform:translateX(-50%); bottom:10px; z-index:10050; width:calc(100% - 40px); max-width:420px; background:rgba(0,0,0,0.75); border-radius:14px; padding:8px 12px; box-shadow:0 6px 20px rgba(0,0,0,0.12); display:flex; gap:12px; align-items:center; justify-content:space-around; overflow:visible; padding-bottom:calc(10px + env(safe-area-inset-bottom)); }
    .bottom-bar .icon-btn{ display:flex; flex-direction:column; align-items:center; justify-content:center; background:transparent; color:#fff; font-size:18px; text-decoration:none; gap:4px; cursor:pointer; overflow:visible; pointer-events:auto; }
    .bottom-bar .icon-btn i{ color:#fff; font-size:18px }
    .bottom-bar .icon-btn span{ font-size:11px; color:#fff; line-height:1 }

    .photo-slider{ width:100%; max-width:360px; margin:12px auto; overflow:hidden; border-radius:12px; position:relative; }
    .photo-slider .slides{ display:flex; transition:transform 400ms ease; will-change:transform; }
    .photo-slider .slide-item{ min-width:100%; flex:0 0 100%; display:flex; align-items:center; justify-content:center; height:200px; }
    .photo-slider .slide-item img{ width:100%; height:100%; object-fit:cover; border-radius:12px; display:block; cursor:pointer; }
    .slider-dots{ display:flex; gap:6px; justify-content:center; margin-top:8px; }
    .slider-dots button{ width:8px; height:8px; border-radius:50%; border:none; background:#ddd; padding:0; }
    .slider-dots button.active{ background:var(--accent); }
    .slider-btn{ position:absolute; top:50%; transform:translateY(-50%); width:36px; height:36px; border-radius:50%; border:none; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.45); color:#fff; font-size:22px; cursor:pointer; z-index:3; }
    .slider-btn.prev{ left:8px; } .slider-btn.next{ right:8px; } .slider-btn:active{ transform:translateY(-50%) scale(0.96); }

    @media (max-width:420px){
      .fixed-overlay.primary{ top:6vh; width:92%; max-width:360px; }
      .fixed-overlay.secondary{ top:2vh; width:96%; max-width:380px; }
      .photo-slider .slide-item{ height:180px; }
      .slider-btn{ width:32px; height:32px; font-size:18px; }
      .contact-card{ width:calc(100% - 28px); padding:16px }
    }

    .bubbles{ display:flex; flex-direction:column; gap:8px; margin:12px 0; max-height:300px; overflow-y:auto; padding-right:4px; scroll-behavior:smooth }
    .bubble{ align-self:flex-start; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.06); padding:10px 14px; border-radius:18px; max-width:90%; box-shadow:0 6px 12px rgba(0,0,0,0.06); }
    .bubble .meta{ font-size:12px; color:var(--muted); margin-bottom:6px; font-weight:600 }
    .bubble .msg{ font-size:14px; color:#fff; line-height:1.4 }
  </style>
</head>
<body>
  <!-- background -->
  <div class="bg-video" aria-hidden="true">
    <img src="https://invitation-v2.mymawaddah.com/storage/wedapp-invitation/design/fr0042/6jgvkT17552257093998.jpg" alt="Wedding Background" />
  </div>

  <!-- OVERLAYS (fade-in on first reveal, then stay) -->
  <div class="fixed-overlay primary" id="overlayPrimary" aria-hidden="true">
    <img src="https://invitation-v2.mymawaddah.com/storage/wedapp-invitation/design/fr0042/1gAdBv175522894697110.png" alt="Overlay Decoration 1">
  </div>

  <div class="fixed-overlay secondary" id="overlaySecondary" aria-hidden="true">
    <img src="https://invitation-v2.mymawaddah.com/storage/wedapp-invitation/design/fr0042/T7EZA1175522895996211.png" alt="Overlay Decoration 2">
  </div>

  <!-- opening overlay (mawaddah) -->
  <div id="openingOverlay" role="dialog" aria-label="Skrin Muka" aria-modal="true">
    <div class="glass-panel glass-left" aria-hidden="true" style="position:absolute;top:0;left:0;height:100vh;width:50vw;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));backdrop-filter:blur(8px);"></div>
    <div class="glass-panel glass-right" aria-hidden="true" style="position:absolute;top:0;right:0;height:100vh;width:50vw;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));backdrop-filter:blur(8px);"></div>
    <div class="opening-seal" id="openingSeal" aria-hidden="true" style="width:140px;height:140px;background:rgba(255,255,255,0.95);border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;font-size:34px;color:#3c4928;z-index:10070;box-shadow:0 14px 40px rgba(0,0,0,0.28);">I|F</div>
  </div>

  <!-- MAIN APP -->
  <div class="app" id="appRoot" aria-hidden="false">
    <section class="intro-section" aria-label="Intro">
      <div class="intro-text" role="heading" aria-level="1">
        <div class="kecil">WALIMATULURUS</div><br><br><br>
        <div class="besar" style="font-family:'FlashFont',serif;font-size:50px">Isma &amp; Fikri</div><br><br><br>
        <div class="tarikh">03 JANUARI 2026 | SABTU</div>
        <div class="lokasi">WHITE HOUSE EVENT SPACE, DUNGUN</div>
      </div>

      <div class="intro-bottom" aria-hidden="false">
        <div class="kecil" style="display:none">WALIMATULURUS</div>
      </div>
    </section>

    <section>
      <div class="content" id="mainCard">
        <!-- TRIGGER: overlay will fade-in when this is visible (then remain visible) -->
        <p id="overlayTrigger">Assalamualaikum &amp; Salam Sejahtera</p>

        <div class="parent-name"><strong>HJ. MOHD SHUHAIMI BIN DAUD</strong></div>
        <div class="parent-name"><strong>&amp;</strong></div>
        <div class="parent-name"><strong>HJH. NOR AZILA BINTI RAMLI</strong></div>

        <p>Dengan penuh kesyukuran kami menjemput,<br>Dato’ | Datin | Tuan | Puan | Encik | Cik<br>ke majlis perkahwinan puteri kami</p><br>

        <div class="couple-name"><strong>SITI ISMAHANI IZZATI BINTI MOHD SHUHAIMI</strong></div>
        <div class="parent-name"><strong>&amp;</strong></div>
        <div class="couple-name"><strong>MUHAMMAD FIKRI BIN ZUHAIRI</strong></div>

        <h2>Butiran Majlis</h2>
        <p><strong>Tarikh:</strong> Sabtu, 03 Januari 2026<br><strong>Masa:</strong> 11:00 pagi - 4:00 petang<br><strong>Tempat:</strong> White House Event Space Dungun</p>

        <h2>Atur Cara</h2>
        <p><strong>Jamuan:</strong> 11.00 AM – 4.00 PM<br><strong>Ketibaan Pengantin:</strong> 12.00 PM</p>

        <h2>Gambar</h2>
        <div class="photo-slider" aria-label="Galeri Gambar" style="margin-top:12px;">
          <button class="slider-btn prev" aria-label="Sebelum">‹</button>
          <div class="slides">
            <div class="slide-item"><img src="https://i.postimg.cc/C5BpCwGw/Whats-App-Image-2025-11-08-at-7-40-37-PM.jpg" alt="Foto 1" loading="lazy" decoding="async"></div>
            <div class="slide-item"><img src="https://i.postimg.cc/RVtzNVCT/Whats-App-Image-2025-11-08-at-7-42-44-PM.jpg" alt="Foto 2" loading="lazy" decoding="async"></div>
          </div>
          <button class="slider-btn next" aria-label="Seterusnya">›</button>
          <div class="slider-dots" aria-hidden="true"></div>
        </div>

        <h2>Ucapan</h2>
        <div class="bubbles" id="bubblesContainer" tabindex="0" aria-live="polite" aria-label="Senarai ucapan"></div>

        <h2>COUNTING DAYS</h2>
        <div class="countdown" id="countdown">
          <div><div class="num" id="days">0</div><div class="lbl">Hari</div></div>
          <div><div class="num" id="hours">0</div><div class="lbl">Jam</div></div>
          <div><div class="num" id="mins">0</div><div class="lbl">Minit</div></div>
          <div><div class="num" id="secs">0</div><div class="lbl">Saat</div></div>
        </div>

        <div id="videoContainer" style="margin-top:12px;text-align:center;">
          <div id="ytPlayer" style="width:100%;max-width:420px;margin:auto;height:200px;"></div>
        </div>

        <footer style="margin-top:28px;">Terima kasih — Kami hargai kehadiran dan doa anda.</footer>
      </div>
    </section>
  </div>

  <!-- bottom-bar -->
  <div class="bottom-bar" role="navigation" aria-label="tindakan">
    <div class="icon-btn" id="callBtn"><i class="fa-solid fa-phone"></i><span>Hubungi</span></div>
    <div class="icon-btn" id="mapBtn"><i class="fa-solid fa-location-dot"></i><span>Lokasi</span></div>
    <div class="icon-btn" id="bottomRsvpBtn"><i class="fa-regular fa-envelope"></i><span>RSVP</span></div>
  </div>

  <!-- hidden iframe for POST -->
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

  <script>
  (function(){
    // --------- CONFIG (paste your endpoints if needed) ----------
    const RSVP_WS_URL = 'https://script.google.com/macros/s/AKfycbzDYI9RXDgtm0E6Li32k8tpsgzYn9WKA3JATB5UUdNbd2cxXLLUM6ARSliRikx-Cx4d/exec';
    const UCAPAN_WS_URL = 'https://script.google.com/macros/s/AKfycbzDYI9RXDgtm0E6Li32k8tpsgzYn9WKA3JATB5UUdNbd2cxXLLUM6ARSliRikx-Cx4d/exec';

    // helper
    function escapeHtml(s){ if (typeof s !== 'string') return s||''; return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'); }
    function showStatus(el, msg, ok){ if(!el) return; el.style.display='block'; el.textContent = msg; el.style.color = ok ? '#0a7a00' : '#b21b1b'; }

    // ---------- Overlay observer (fade-in once, then remain) ----------
    (function overlayObserver(){
      const primary = document.getElementById('overlayPrimary');
      const secondary = document.getElementById('overlaySecondary');
      const trigger = document.getElementById('overlayTrigger');

      if(!trigger || (!primary && !secondary) || !('IntersectionObserver' in window)) {
        primary && primary.classList.add('visible');
        secondary && secondary.classList.add('visible');
        return;
      }

      const options = { root: null, rootMargin: '0px 0px -40% 0px', threshold: 0 };
      let shown = false;
      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if(entry.isIntersecting && !shown) {
            primary && primary.classList.add('visible');
            secondary && secondary.classList.add('visible');
            shown = true;
            // stop observing — overlay will remain visible forever
            try{ io.disconnect(); }catch(e){}
          }
        });
      }, options);
      io.observe(trigger);
    })();

    // ---------- Image modal ----------
    const images = document.querySelectorAll('.photo-slider img');
    const imageModal = document.createElement('div');
    imageModal.id = 'imageModal';
    imageModal.className = 'modal';
    imageModal.style.display = 'none';
    const modalClose = document.createElement('span');
    modalClose.className = 'close';
    modalClose.id = 'imageModalClose';
    modalClose.textContent = '×';
    const modalImg = document.createElement('img');
    modalImg.className = 'modal-content';
    imageModal.appendChild(modalClose);
    imageModal.appendChild(modalImg);
    document.body.appendChild(imageModal);

    images.forEach(function(img){
      img.addEventListener('click', function(){
        modalImg.src = img.src;
        imageModal.style.display = 'block';
        imageModal.setAttribute('aria-hidden','false');
      });
    });
    modalClose.addEventListener('click', function(){ imageModal.style.display='none'; imageModal.setAttribute('aria-hidden','true'); });
    window.addEventListener('click', function(ev){ if(ev.target === imageModal) { imageModal.style.display='none'; imageModal.setAttribute('aria-hidden','true'); } });

    // ---------- bottom bar behaviour (simple) ----------
    const callBtn = document.getElementById('callBtn');
    const mapBtn = document.getElementById('mapBtn');
    const bottomRsvpBtn = document.getElementById('bottomRsvpBtn');
    if(callBtn) callBtn.addEventListener('click', ()=> { window.location.href = 'tel:+60199150821'; });
    if(mapBtn) mapBtn.addEventListener('click', ()=> { window.open('https://maps.app.goo.gl/Z2F3c86dVen1ciR29','_blank'); });
    if(bottomRsvpBtn) bottomRsvpBtn.addEventListener('click', ()=> { alert('Buka RSVP (paste your RSVP handler here)'); });

    // ---------- JSONP loader for ucapan list ----------
    const bubblesContainer = document.getElementById('bubblesContainer');
    window.__ucapan_jsonp_cb = function(data){
      try {
        if(!data || !Array.isArray(data.items)) return;
        renderUcapanList(data.items);
      } catch(e){ console.warn('jsonp cb error', e); }
    };
    function loadUcapan_JSONP_thenRender(){
      const cbName = '__ucapan_jsonp_cb';
      const src = UCAPAN_WS_URL + (UCAPAN_WS_URL.indexOf('?') === -1 ? '?' : '&') + 'api=ucapan&callback=' + cbName + '&_=' + Date.now();
      const s = document.createElement('script');
      s.src = src;
      s.onerror = function(){ console.warn('JSONP load error for', src); s.remove(); };
      document.body.appendChild(s);
      setTimeout(()=>{ try{ document.body.removeChild(s); }catch(e){} }, 9000);
    }
    function renderUcapanList(items){
      try {
        if(!bubblesContainer) return;
        bubblesContainer.innerHTML = '';
        let arr = Array.from(items || []);
        try {
          if(arr.length >= 2){
            const a = new Date(arr[0].timestamp || arr[0].Timestamp || arr[0].ts || 0);
            const b = new Date(arr[arr.length-1].timestamp || arr[arr.length-1].Timestamp || arr[arr.length-1].ts || 0);
            if(!isNaN(a) && !isNaN(b) && a < b) arr = arr.reverse();
          }
        } catch(e){ /* ignore */ }
        arr.forEach(it => {
          const nama = it.nama || it.Nama || it.name || '';
          const ucapan = it.ucapan || it.Ucapan || it.message || '';
          const ts = it.timestamp || it.Timestamp || it.ts || '';
          const bubble = document.createElement('div'); bubble.className='bubble';
          const timeLabel = ts ? (new Date(ts)).toLocaleString() : (new Date()).toLocaleString();
          bubble.innerHTML = '<div class=\"meta\">'+escapeHtml(nama)+' • <span style=\"font-size:11px;color:#999\">'+escapeHtml(timeLabel)+'</span></div><div class=\"msg\">'+escapeHtml(ucapan)+'</div>';
          bubblesContainer.appendChild(bubble);
        });
        setTimeout(()=>{ try{ bubblesContainer.scrollTo({ top: 0, behavior:'smooth' }); }catch(e){} }, 60);
      } catch(e){ console.warn('renderUcapanList error', e); }
    }
    loadUcapan_JSONP_thenRender();

    // ---------- postFormNoCORS helper ----------
    function postFormNoCORS(url, data, callback) {
      try {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = url;
        form.target = 'hidden_iframe';
        form.style.display = 'none';
        for (const k in data){
          const inp = document.createElement('input');
          inp.type = 'hidden';
          inp.name = k;
          inp.value = data[k];
          form.appendChild(inp);
        }
        document.body.appendChild(form);
        const iframe = document.getElementById('hidden_iframe');
        let called = false;
        function onLoad(){
          if (called) return;
          called = true;
          try { iframe.removeEventListener('load', onLoad); } catch(e){}
          setTimeout(()=>{ if(callback) callback(true); try{ document.body.removeChild(form); }catch(e){} }, 150);
        }
        iframe.addEventListener('load', onLoad);
        form.submit();
        setTimeout(()=>{ if (called) return; called = true; try{ iframe.removeEventListener('load', onLoad);}catch(e){} if(callback) callback(false); try{ document.body.removeChild(form); }catch(e){} }, 4000);
      } catch(err){
        console.warn('postFormNoCORS error', err);
        if(callback) callback(false);
      }
    }

    // ---------- countdown ----------
    function pad(n){ return String(n).padStart(2,'0'); }
    const eventDate = new Date('2026-01-03T11:00:00+08:00');
    function updateCountdown(){
      const now = new Date();
      let diff = Math.max(0, Math.floor((eventDate - now) / 1000));
      const days = Math.floor(diff / 86400); diff %= 86400;
      const hours = Math.floor(diff / 3600); diff %= 3600;
      const mins = Math.floor(diff / 60); const secs = diff % 60;
      const daysEl = document.getElementById('days');
      const hoursEl = document.getElementById('hours');
      const minsEl = document.getElementById('mins');
      const secsEl = document.getElementById('secs');
      if(daysEl) daysEl.textContent = days;
      if(hoursEl) hoursEl.textContent = pad(hours);
      if(minsEl) minsEl.textContent = pad(mins);
      if(secsEl) secsEl.textContent = pad(secs);
    }
    updateCountdown();
    setInterval(updateCountdown, 1000);

    // ---------- opening overlay flow (auto enter) ----------
    (function openingFlow(){
      const openingOverlay = document.getElementById('openingOverlay');
      const app = document.getElementById('appRoot');
      document.documentElement.style.overflow = 'hidden';
      document.body.style.overflow = 'hidden';
      if (app) app.setAttribute('aria-hidden','true');
      function kickoff(){
        document.body.classList.add('opening-opened');
        if (openingOverlay) {
          openingOverlay.style.pointerEvents = 'none';
          openingOverlay.classList && openingOverlay.classList.add('fade-out');
        }
        document.documentElement.style.overflow = '';
        document.body.style.overflow = '';
        if (app) app.setAttribute('aria-hidden','false');
        const safeRemoveDelay = 1200 + 400;
        setTimeout(()=>{ try{ openingOverlay && openingOverlay.remove(); }catch(e){} }, safeRemoveDelay);
      }
      if (document.readyState === 'complete' || document.readyState === 'interactive') {
        setTimeout(kickoff, 1200);
      } else {
        window.addEventListener('load', ()=> setTimeout(kickoff, 1200), { once:true });
        document.addEventListener('DOMContentLoaded', ()=> setTimeout(kickoff, 1200), { once:true });
      }
      window.forceEnter = kickoff;
    })();

    // ---------- YouTube autoplay (muted) ----------
    (function(){
      if(!document.getElementById('yt-iframe-api')){
        const s = document.createElement('script');
        s.id = 'yt-iframe-api';
        s.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(s);
      }
      window.ytPlayer = null;
      window.onYouTubeIframeAPIReady = function(){
        try {
          window.ytPlayer = new YT.Player('ytPlayer', {
            height: '200',
            width: '100%',
            videoId: 'JmIUdR_fob0',
            playerVars: { autoplay: 1, controls: 1, rel: 0, modestbranding: 1, playsinline: 1, mute: 1 },
            events: { onReady: function(e){ try { e.target.playVideo(); } catch(err){ console.warn('play error', err); } } }
          });
        } catch(e){ console.warn('YT player error', e); }
      };
      function tryUnmute(){
        try {
          if(window.ytPlayer && typeof window.ytPlayer.unMute === 'function'){
            window.ytPlayer.unMute();
            window.ytPlayer.playVideo();
          }
        } catch(e){ console.warn('unmute failed', e); }
        window.removeEventListener('click', tryUnmute);
        window.removeEventListener('touchstart', tryUnmute);
      }
      window.addEventListener('click', tryUnmute, { once: true });
      window.addEventListener('touchstart', tryUnmute, { once: true });
    })();

    // ---------- photo slider (auto + touch + arrows + dots) ----------
    (function(){
      try{
        const container = document.querySelector('.photo-slider');
        if(!container) return;
        const slider = container.querySelector('.slides');
        const prevBtn = container.querySelector('.slider-btn.prev');
        const nextBtn = container.querySelector('.slider-btn.next');
        const slides = slider.children;
        const total = slides.length;
        const dots = container.querySelector('.slider-dots');
        let idx = 0;
        let autoT = null;
        let animBlocked = false;

        for(let i=0;i<total;i++){
          const b = document.createElement('button');
          b.type = 'button';
          b.addEventListener('click', ()=>{ go(i); });
          dots.appendChild(b);
        }

        function updateDots(){ Array.from(dots.children).forEach((b,i)=>b.classList.toggle('active', i===idx)); }
        function go(i){ if(animBlocked) return; animBlocked = true; idx = (i + total) % total; slider.style.transform = 'translateX(-'+(idx*100)+'%)'; updateDots(); setTimeout(()=>{ animBlocked=false; }, 450); }

        if(prevBtn) prevBtn.addEventListener('click', function(e){ e.stopPropagation(); go(idx-1); });
        if(nextBtn) nextBtn.addEventListener('click', function(e){ e.stopPropagation(); go(idx+1); });

        function startAuto(){ stopAuto(); autoT = setInterval(()=> go(idx+1), 3500); }
        function stopAuto(){ if(autoT) { clearInterval(autoT); autoT = null; } }
        startAuto();

        container.addEventListener('mouseenter', stopAuto);
        container.addEventListener('mouseleave', startAuto);

        let startX = 0, curX = 0, dragging = false;
        slider.addEventListener('touchstart', function(e){ startX = e.touches[0].clientX; dragging = true; stopAuto(); }, {passive:true});
        slider.addEventListener('touchmove', function(e){ if(!dragging) return; curX = e.touches[0].clientX; const delta = (curX - startX) / container.clientWidth * 100; slider.style.transform = 'translateX(' + ( -idx*100 + delta ) + '%)'; }, {passive:true});
        slider.addEventListener('touchend', function(){ dragging = false; const diff = curX - startX; if(diff > 50) go(idx-1); else if(diff < -50) go(idx+1); else go(idx); startAuto(); });

        container.tabIndex = 0;
        container.addEventListener('keydown', function(e){ if(e.key === 'ArrowLeft') go(idx-1); if(e.key === 'ArrowRight') go(idx+1); });

        updateDots();
      }catch(e){ console.warn('slider init', e); }
    })();

    // End of IIFE
  })();
  </script>
</body>
</html>
